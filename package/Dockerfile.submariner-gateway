FROM quay.io/submariner/submariner-iptables-base:devel
ARG TARGETPLATFORM

WORKDIR /var/submariner

# libreswan provides IKE
RUN dnf -y install --nodocs --setopt=install_weak_deps=0 \
           libreswan && \
    dnf -y clean all

COPY package/submariner.sh package/pluto bin/${TARGETPLATFORM}/submariner-engine /usr/local/bin/

ENTRYPOINT submariner.sh
